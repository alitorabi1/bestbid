<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>bid</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="assets/css/main.css" />
        <link rel="stylesheet" href="assets/css/ie9.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>       
        <script>      




            function loadCategories() {
                $("#categoryList").html("");
                var ID = $("#mainCategoryList").val();
                ///api.php/todoitems/" + currentID
                $.ajax({
                    url: "/api.php/category/" + ID,
                    // data: {},

                    statusCode: {
                        401: function (xhr) {
                            // $("#loginPane").show();
                            // $("#listPane").hide();
                        }
                    },
                    type: "GET",
                    dataType: "json"
                }).done(function (data) {

                    var opts = "";
                    for (var i = 0; i < data.length; i++) {
                        opts += '<option value="' + data[i].ID + '">' + data[i].name + '</option>';
                    }
                    $("#categoryList").html(opts);
                });
            }
            function showMainCategory() {

                $.ajax({
                    url: "/api.php/maincategory",
                    // data: {},

                    statusCode: {
                        401: function (xhr) {
                            // $("#loginPane").show();
                            // $("#listPane").hide();
                        }
                    },
                    type: "GET",
                    dataType: "json"
                }).done(function (data) {
                    // var sel = $('#categoryList');
                    var opts = "";
                    for (var i = 0; i < data.length; i++) {
                        opts += '<option value="' + data[i].ID + '">' + data[i].name + '</option>';
                    }
                    $("#mainCategoryList").html(opts);
                    $("#mainCategoryList").val(1);
                    loadCategories();
                });

            }

            $(document).ready(function () {
               
                showMainCategory();
                $("#addSell").click(function () {
                    // FIXME: verify inputs seem okay,
                    // * title is at least 1-100 chars long
                    // * dueDate must be chosen
                    var userID = 1;
                    var categoryID = $("#categoryList").val();
                    var name = $("input[name=name]").val();
                    var description = $("input[name=description]").val();
                    var itemPic = $("input[name=itemPic]").val();
                    var bidType = $("input[name=bidType]").val();
                    var minimumBid = $("input[name=minimumBid]").val();
                    var bidStartTime = $("input[name=bidStartTime]").val();
                    var bidEndTime = $("input[name=bidEndTime]").val();
                    var shippingFee = $("input[name=shippingFee]").val();
                    // INSERT
                    $.ajax({
                        url: "/api.php/itemsforsell",
                        //  statusCode: {
                        //   400: function (xhr) {
                        //    var msg = xhr.responseText;
                        //  alert("400 received: " + msg);
                        // }
                        // },
                        data: JSON.stringify({
                            categoryID: categoryID,
                            userID: userID,
                            name: name,
                            itemPic:itemPic,
                            description: description,
                            bidType: bidType,
                            minimumBid: minimumBid,
                            bidStartTime: bidStartTime,
                            bidEndTime: bidEndTime,
                            shippingFee: shippingFee

                        }),
                        type: "POST",
                        dataType: "json"
                    }).done(function () {
                        alert("Addedd successfully");

                    });

                });

            });

        </script>
    </head>
    <body>
        <div class="container">
            <select name="maincategoryList" id="mainCategoryList" onchange="loadCategories()">               
            </select><br>
            <select name="categoryList" id="categoryList">               
            </select><br>
            item name for sell: <input type="text" name="name"  class="mycss"><br>
            description: <input type="text" name="description" class="mycss"><br>
            <form action="upload.php" method="post" enctype="multipart/form-data">
                Choose item picture:
                <input type="file" name="itemPic">
                <!---   <input type="submit" value="Upload Image" name="submit">--->
            </form>
            Bid Type: <input type="text" name="bidType" class="mycss"><br>
            Minimum Bid Amount(CAD)<input type="number" step="0.01" name="minimumBid" class="mycss"><br>
            Bid Start Time:<input class="mycss" type="date"  name="bidStartTime"  >
            Bid Start Time:<input type="time"  name="bidStartT">
            Bid End Time:<input class="mycss" type="date"  name="bidEndTime" >
            <input type="time"  class="mycss" name="bidStartT" >
            Shipping Fee(CAD)<input type="number" step="0.01" name="shippingFee" class="mycss"><br>
            <button   class="button-big,mycss" id="addSell" >Add your Item for sell</button>


        </div>
    </body>
</html>
